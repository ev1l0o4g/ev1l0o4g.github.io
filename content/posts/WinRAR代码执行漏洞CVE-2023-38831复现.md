---
title: "WinRAR代码执行漏洞CVE-2023-38831复现"
date: 2023-08-28T15:43:55+08:00
draft: false
categories:
- 漏洞复现
tags:
- 漏洞复现
---

# 复现环境

- Windows11（貌似自带7-zip）
![r6bghq.png](https://files.catbox.moe/r6bghq.png)

- WinRAR 6.20
![9nrwry.png](https://files.catbox.moe/9nrwry.png)

# 漏洞详情

WinRAR 在处理压缩包内同名的文件与文件夹时代码执行漏洞，攻击者构建由恶意文件与非恶意文件构成的特制压缩包文件，诱导受害者打开此文件后，将在受害者机器上执行任意代码。

# 影响版本

WinRAR < 6.23

# 漏洞复现

创建CVE-2023-38831文件夹，在该文件夹创建test文件夹，test文件夹内创建38831.txt文件，内容随意。
![13hxp5.png](https://files.catbox.moe/13hxp5.png)

回到CVE-2023-38831文件夹，创建新的文件夹，命名为38831.txt。
![MP4XkfYaKhboqAW.png](https://s2.loli.net/2023/08/28/MP4XkfYaKhboqAW.png)

接着在38831.txt文件夹创建名为38831.txt .cmd文件，注意有空格，内容为弹calc。
![2dv9kceSRs7tfy5.png](https://s2.loli.net/2023/08/28/2dv9kceSRs7tfy5.png)

使用WinRAR将38831.txt文件夹重命名压缩
![4vfxDz1NtIuWUZh.png](https://s2.loli.net/2023/08/28/4vfxDz1NtIuWUZh.png)

并追加test文件夹内的38831.txt文件
![Ipx974WQZanPLdC.png](https://s2.loli.net/2023/08/28/Ipx974WQZanPLdC.png)

使用WinRAR打开压缩后的exploit_38831.zip文件，在38831.txt后追加一个空格
![J9vjWMIoN4tVgPy.png](https://s2.loli.net/2023/08/28/J9vjWMIoN4tVgPy.png)

双击38831.txt文件即可执行命令
![ybsFUXBRNgKLZpo.png](https://s2.loli.net/2023/08/28/ybsFUXBRNgKLZpo.png)

该漏洞可用于钓鱼，若受害者使用的WinRAR版本低于6.23，打开了攻击者构造的恶意文件即可达到攻击者目的。

# 漏洞修复
升级WinRAR至6.23及以上。
https://www.rarlab.com/